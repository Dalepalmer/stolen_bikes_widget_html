var appendBikes,bikeList,getFuzzySerialResponse,getNearbyStolen,getSerialResponse,searchSerialsFuzzy,trim,unlockSearch;Array.prototype.uniq=function(){var e,t,r,s,a,i;for(t={},e=s=0,a=this.length;a>=0?a>s:s>a;e=a>=0?++s:--s)t[this[e]]=this[e];i=[];for(e in t)r=t[e],i.push(r);return i},trim=function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},unlockSearch=function(){return $("#multiserial_fuzzy, #search_serials").addClass("ms_unlocked")},getSerialResponse=function(e){var t,r;return t=$("#search_serials").attr("data-target"),r=this,$.ajax({type:"GET",url:"https://bikeindex.org/api/v1/bikes?serial="+e,success:function(e){return r.appendBikes(e.bikes)}})},bikeList=function(e){var t,r,s,a,i,n;for(s="",r=i=0,n=e.length;n>i&&(t=e[r],!(r>8));r=++i)s+="<li>",null!=t.thumb&&(s+="<a href='"+t.url+"' class='stolen-thumb'><img src='"+t.thumb+"'></a>"),s+="<h4><a href='"+t.url+"'>"+t.title+"</a></h4>",t.stolen&&(a=new Date(Date.parse(t.stolen_record.date_stolen)),a=a.toString().split(/\d{2}:/)[0],s+="<p>Stolen from "+t.stolen_record.location+" &mdash; on "+a+"</p>"),s+="<p>Serial: <span class='serial-text'>"+t.serial+"</span></p>";return s},appendBikes=function(e,t){var r;return null==t&&(t=!1),r="",$("#bi-stolen-widget ul").html(bikeList(e))},searchSerialsFuzzy=function(e){var t,r,s,a,i,n;if(e.preventDefault(),!$("#multiserial_fuzzy").hasClass("ms_unlocked"))return!0;for($("#multiserial_fuzzy").removeClass("ms_unlocked"),i=$("#serials_submitted li"),n=[],s=0,a=i.length;a>s;s++)t=i[s],r=$(t).attr("name"),n.push(this.getFuzzySerialResponse(r));return n},getFuzzySerialResponse=function(e){var t,r;return t=$("#multiserial_fuzzy").attr("data-target"),r=this,$.ajax({type:"GET",url:""+t+"?serial="+e,success:function(t){return t.bikes.length>1?r.appendBikes(t.bikes,e,!0):void 0}})},getNearbyStolen=function(e){var t,r,s;return s="https://bikeindex.org/api/v1/bikes?stolen=true&proximity="+e+"&proximity_radius=100",t=$("#search_serials").attr("data-target"),r=this,$.ajax({type:"GET",url:s,success:function(e){return r.appendBikes(e.bikes)}})},$(document).ready(function(){return getNearbyStolen($("#bi-stolen-widget").attr("data-location")),$("#bi_submit").click(function(){return getSerialResponse($("#bi_search").val())})});